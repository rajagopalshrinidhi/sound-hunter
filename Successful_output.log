
Shrinidhis-MacBook-Air:sound-hunter shrinidhirajagopal$ ./run.sh 
=== Sound Hunter Project Setup ===
Python 3.10+ not found. Attempting to install...
Installing Python 3.10 via Homebrew...
Error: 
  homebrew-core is a shallow clone.
  homebrew-cask is a shallow clone.
To `brew update`, first run:
  git -C /usr/local/Homebrew/Library/Taps/homebrew/homebrew-core fetch --unshallow
  git -C /usr/local/Homebrew/Library/Taps/homebrew/homebrew-cask fetch --unshallow
These commands may take a few minutes to run due to the large size of the repositories.
This restriction has been made on GitHub's request because updating shallow
clones is an extremely expensive operation due to the tree layout and traffic of
Homebrew/homebrew-core and Homebrew/homebrew-cask. We don't do this for you
automatically to avoid repeatedly performing an expensive unshallow operation in
CI systems (which should instead be fixed to not use shallow clones). Sorry for
the inconvenience!
==> Downloading https://ghcr.io/v2/homebrew/core/python/3.10/manifests/3.10.19_1
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/0e517347476565f8fa7743f84b3c04e6718fa7fcf67af3b44412fb9064a0c8f4--python@3.10-3.10.19_1.bottle_manifest.json
==> Fetching dependencies for python@3.10: gdbm, ca-certificates, openssl@3, readline and sqlite
==> Downloading https://ghcr.io/v2/homebrew/core/gdbm/manifests/1.26
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/35ff1d9b15ba5c57e64b9d7f5e18d12ddda40b5ecdc8ecf2f136c49928265f9d--gdbm-1.26.bottle_manifest.json
==> Fetching gdbm
==> Downloading https://ghcr.io/v2/homebrew/core/gdbm/blobs/sha256:bc3db54835cc359259f83e3d0b3063
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/7b2a74b9d7a5de7967de2e69594ce8bccab18c0b1210600622d9aed315e347f4--gdbm--1.26.sonoma.bottle.tar.gz
==> Downloading https://ghcr.io/v2/homebrew/core/ca-certificates/manifests/2025-12-02
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/cbb73f87e0331e0d1422d5d71643918b0833954b03cee5aa178acbee4900f939--ca-certificates-2025-12-02.bottle_manifest.json
==> Fetching ca-certificates
==> Downloading https://ghcr.io/v2/homebrew/core/ca-certificates/blobs/sha256:dd8e78402d2feff017e
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/b4902605ac6df93cbe6664aece03fe0c9fc3a1ac79ed37b1cf64227b06c31941--ca-certificates--2025-12-02.all.bottle.tar.gz
==> Downloading https://ghcr.io/v2/homebrew/core/openssl/3/manifests/3.6.0
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/403c903e557d19d801f4c6b4f635c9553af72a487024139a5773e636c884ef9e--openssl@3-3.6.0.bottle_manifest.json
==> Fetching openssl@3
==> Downloading https://ghcr.io/v2/homebrew/core/openssl/3/blobs/sha256:a015d2e06290484b37547a57b
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/8dc0f2d4b5d1dc3675652c2239ed47f365d72b5ec28d9c875fddff6150f0b7a0--openssl@3--3.6.0.sequoia.bottle.tar.gz
==> Downloading https://ghcr.io/v2/homebrew/core/readline/manifests/8.3.3
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/0e2d3ef81d48d7d0f5f076c00df9526c2b7ebb2de9bff3972e4d3faabe24d3fb--readline-8.3.3.bottle_manifest.json
==> Fetching readline
==> Downloading https://ghcr.io/v2/homebrew/core/readline/blobs/sha256:fd72a581442e1826e1386b8620
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/1dd969814acf96913d41a69b02bdbe92c91714b32b452b36a6f9f2dc890fc7e7--readline--8.3.3.sequoia.bottle.tar.gz
==> Downloading https://ghcr.io/v2/homebrew/core/sqlite/manifests/3.51.1
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/8029a2f3294bb0f1af11d682b254763c6c2c53eaede029ccedc9362bc94aa186--sqlite-3.51.1.bottle_manifest.json
==> Fetching sqlite
==> Downloading https://ghcr.io/v2/homebrew/core/sqlite/blobs/sha256:2422b6f9bab98baab5c64e76d91f
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/31e96081f14d54daaf001be48a34efd04f4de49291a3bf48c6ba107a05896ce5--sqlite--3.51.1.sequoia.bottle.tar.gz
==> Fetching python@3.10
==> Downloading https://ghcr.io/v2/homebrew/core/python/3.10/blobs/sha256:41d2532e5b733bfeb604e68
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/e89623176ce489e6518a46d7106db2f9903ea8d2faa6e991b47c77e2cfaf3f9f--python@3.10--3.10.19_1.sonoma.bottle.tar.gz
==> Installing dependencies for python@3.10: gdbm, ca-certificates, openssl@3, readline and sqlite
==> Installing python@3.10 dependency: gdbm
==> Downloading https://ghcr.io/v2/homebrew/core/gdbm/manifests/1.26
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/35ff1d9b15ba5c57e64b9d7f5e18d12ddda40b5ecdc8ecf2f136c49928265f9d--gdbm-1.26.bottle_manifest.json
==> Pouring gdbm--1.26.sonoma.bottle.tar.gz
Error: Permission denied @ rb_file_s_rename - (/private/tmp/homebrew-unpack-20260105-73504-3izq38/gdbm/1.26, /usr/local/Cellar/gdbm/1.26)
Using Python version: 3.10.19

Creating virtual environment...
Virtual environment already exists. Removing old one...
Activating virtual environment...

Upgrading pip...
Requirement already satisfied: pip in ./venv/lib/python3.10/site-packages (25.3)

Installing required packages...
Collecting jax (from -r requirements.txt (line 1))
  Using cached jax-0.6.2-py3-none-any.whl.metadata (13 kB)
Collecting jaxlib (from -r requirements.txt (line 2))
  Using cached jaxlib-0.6.2-cp310-cp310-macosx_11_0_arm64.whl.metadata (1.3 kB)
Collecting tesseract-core>=0.9.0 (from -r requirements.txt (line 5))
  Using cached tesseract_core-1.2.0-py3-none-any.whl.metadata (7.5 kB)
Collecting numpy>=1.26.0 (from -r requirements.txt (line 6))
  Using cached numpy-2.2.6-cp310-cp310-macosx_14_0_arm64.whl.metadata (62 kB)
Collecting scipy>=1.11.0 (from -r requirements.txt (line 7))
  Using cached scipy-1.15.3-cp310-cp310-macosx_14_0_arm64.whl.metadata (61 kB)
Collecting librosa>=0.10.0 (from -r requirements.txt (line 10))
  Using cached librosa-0.11.0-py3-none-any.whl.metadata (8.7 kB)
Collecting soundfile>=0.12.0 (from -r requirements.txt (line 11))
  Using cached soundfile-0.13.1-py2.py3-none-macosx_11_0_arm64.whl.metadata (16 kB)
Collecting scikit-learn>=1.3.0 (from -r requirements.txt (line 14))
  Using cached scikit_learn-1.7.2-cp310-cp310-macosx_12_0_arm64.whl.metadata (11 kB)
Collecting pydantic>=2.0.0 (from -r requirements.txt (line 17))
  Using cached pydantic-2.12.5-py3-none-any.whl.metadata (90 kB)
Collecting ml_dtypes>=0.5.0 (from jax->-r requirements.txt (line 1))
  Using cached ml_dtypes-0.5.4-cp310-cp310-macosx_10_9_universal2.whl.metadata (8.9 kB)
Collecting opt_einsum (from jax->-r requirements.txt (line 1))
  Using cached opt_einsum-3.4.0-py3-none-any.whl.metadata (6.3 kB)
Collecting jinja2 (from tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached jinja2-3.1.6-py3-none-any.whl.metadata (2.9 kB)
Requirement already satisfied: pip in ./venv/lib/python3.10/site-packages (from tesseract-core>=0.9.0->-r requirements.txt (line 5)) (25.3)
Collecting pyyaml (from tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached pyyaml-6.0.3-cp310-cp310-macosx_11_0_arm64.whl.metadata (2.4 kB)
Collecting requests>=2.32.4 (from tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached requests-2.32.5-py3-none-any.whl.metadata (4.9 kB)
Collecting rich (from tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached rich-14.2.0-py3-none-any.whl.metadata (18 kB)
Collecting typer (from tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached typer-0.21.0-py3-none-any.whl.metadata (16 kB)
Collecting audioread>=2.1.9 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached audioread-3.1.0-py3-none-any.whl.metadata (9.0 kB)
Collecting numba>=0.51.0 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached numba-0.63.1-cp310-cp310-macosx_11_0_arm64.whl.metadata (2.9 kB)
Collecting joblib>=1.0 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached joblib-1.5.3-py3-none-any.whl.metadata (5.5 kB)
Collecting decorator>=4.3.0 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached decorator-5.2.1-py3-none-any.whl.metadata (3.9 kB)
Collecting pooch>=1.1 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached pooch-1.8.2-py3-none-any.whl.metadata (10 kB)
Collecting soxr>=0.3.2 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached soxr-1.0.0-cp310-cp310-macosx_11_0_arm64.whl.metadata (5.6 kB)
Collecting typing_extensions>=4.1.1 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
Collecting lazy_loader>=0.1 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached lazy_loader-0.4-py3-none-any.whl.metadata (7.6 kB)
Collecting msgpack>=1.0 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached msgpack-1.1.2-cp310-cp310-macosx_11_0_arm64.whl.metadata (8.1 kB)
Collecting cffi>=1.0 (from soundfile>=0.12.0->-r requirements.txt (line 11))
  Using cached cffi-2.0.0-cp310-cp310-macosx_11_0_arm64.whl.metadata (2.6 kB)
Collecting threadpoolctl>=3.1.0 (from scikit-learn>=1.3.0->-r requirements.txt (line 14))
  Using cached threadpoolctl-3.6.0-py3-none-any.whl.metadata (13 kB)
Collecting annotated-types>=0.6.0 (from pydantic>=2.0.0->-r requirements.txt (line 17))
  Using cached annotated_types-0.7.0-py3-none-any.whl.metadata (15 kB)
Collecting pydantic-core==2.41.5 (from pydantic>=2.0.0->-r requirements.txt (line 17))
  Using cached pydantic_core-2.41.5-cp310-cp310-macosx_11_0_arm64.whl.metadata (7.3 kB)
Collecting typing-inspection>=0.4.2 (from pydantic>=2.0.0->-r requirements.txt (line 17))
  Using cached typing_inspection-0.4.2-py3-none-any.whl.metadata (2.6 kB)
Collecting pycparser (from cffi>=1.0->soundfile>=0.12.0->-r requirements.txt (line 11))
  Using cached pycparser-2.23-py3-none-any.whl.metadata (993 bytes)
Collecting packaging (from lazy_loader>=0.1->librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached packaging-25.0-py3-none-any.whl.metadata (3.3 kB)
Collecting llvmlite<0.47,>=0.46.0dev0 (from numba>=0.51.0->librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached llvmlite-0.46.0-cp310-cp310-macosx_11_0_arm64.whl.metadata (5.0 kB)
Collecting platformdirs>=2.5.0 (from pooch>=1.1->librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached platformdirs-4.5.1-py3-none-any.whl.metadata (12 kB)
Collecting charset_normalizer<4,>=2 (from requests>=2.32.4->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached charset_normalizer-3.4.4-cp310-cp310-macosx_10_9_universal2.whl.metadata (37 kB)
Collecting idna<4,>=2.5 (from requests>=2.32.4->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached idna-3.11-py3-none-any.whl.metadata (8.4 kB)
Collecting urllib3<3,>=1.21.1 (from requests>=2.32.4->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached urllib3-2.6.2-py3-none-any.whl.metadata (6.6 kB)
Collecting certifi>=2017.4.17 (from requests>=2.32.4->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached certifi-2026.1.4-py3-none-any.whl.metadata (2.5 kB)
Collecting MarkupSafe>=2.0 (from jinja2->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached markupsafe-3.0.3-cp310-cp310-macosx_11_0_arm64.whl.metadata (2.7 kB)
Collecting markdown-it-py>=2.2.0 (from rich->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached markdown_it_py-4.0.0-py3-none-any.whl.metadata (7.3 kB)
Collecting pygments<3.0.0,>=2.13.0 (from rich->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached pygments-2.19.2-py3-none-any.whl.metadata (2.5 kB)
Collecting mdurl~=0.1 (from markdown-it-py>=2.2.0->rich->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached mdurl-0.1.2-py3-none-any.whl.metadata (1.6 kB)
Collecting click>=8.0.0 (from typer->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached click-8.3.1-py3-none-any.whl.metadata (2.6 kB)
Collecting shellingham>=1.3.0 (from typer->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached shellingham-1.5.4-py2.py3-none-any.whl.metadata (3.5 kB)
Using cached jax-0.6.2-py3-none-any.whl (2.7 MB)
Using cached jaxlib-0.6.2-cp310-cp310-macosx_11_0_arm64.whl (54.3 MB)
Using cached tesseract_core-1.2.0-py3-none-any.whl (104 kB)
Using cached numpy-2.2.6-cp310-cp310-macosx_14_0_arm64.whl (5.3 MB)
Using cached scipy-1.15.3-cp310-cp310-macosx_14_0_arm64.whl (22.4 MB)
Using cached librosa-0.11.0-py3-none-any.whl (260 kB)
Using cached soundfile-0.13.1-py2.py3-none-macosx_11_0_arm64.whl (1.1 MB)
Using cached scikit_learn-1.7.2-cp310-cp310-macosx_12_0_arm64.whl (8.7 MB)
Using cached pydantic-2.12.5-py3-none-any.whl (463 kB)
Using cached pydantic_core-2.41.5-cp310-cp310-macosx_11_0_arm64.whl (1.9 MB)
Using cached annotated_types-0.7.0-py3-none-any.whl (13 kB)
Using cached audioread-3.1.0-py3-none-any.whl (23 kB)
Using cached cffi-2.0.0-cp310-cp310-macosx_11_0_arm64.whl (180 kB)
Using cached decorator-5.2.1-py3-none-any.whl (9.2 kB)
Using cached joblib-1.5.3-py3-none-any.whl (309 kB)
Using cached lazy_loader-0.4-py3-none-any.whl (12 kB)
Using cached ml_dtypes-0.5.4-cp310-cp310-macosx_10_9_universal2.whl (679 kB)
Using cached msgpack-1.1.2-cp310-cp310-macosx_11_0_arm64.whl (83 kB)
Using cached numba-0.63.1-cp310-cp310-macosx_11_0_arm64.whl (2.7 MB)
Using cached llvmlite-0.46.0-cp310-cp310-macosx_11_0_arm64.whl (37.2 MB)
Using cached pooch-1.8.2-py3-none-any.whl (64 kB)
Using cached packaging-25.0-py3-none-any.whl (66 kB)
Using cached platformdirs-4.5.1-py3-none-any.whl (18 kB)
Using cached requests-2.32.5-py3-none-any.whl (64 kB)
Using cached charset_normalizer-3.4.4-cp310-cp310-macosx_10_9_universal2.whl (209 kB)
Using cached idna-3.11-py3-none-any.whl (71 kB)
Using cached urllib3-2.6.2-py3-none-any.whl (131 kB)
Using cached certifi-2026.1.4-py3-none-any.whl (152 kB)
Using cached soxr-1.0.0-cp310-cp310-macosx_11_0_arm64.whl (164 kB)
Using cached threadpoolctl-3.6.0-py3-none-any.whl (18 kB)
Using cached typing_extensions-4.15.0-py3-none-any.whl (44 kB)
Using cached typing_inspection-0.4.2-py3-none-any.whl (14 kB)
Using cached jinja2-3.1.6-py3-none-any.whl (134 kB)
Using cached markupsafe-3.0.3-cp310-cp310-macosx_11_0_arm64.whl (12 kB)
Using cached opt_einsum-3.4.0-py3-none-any.whl (71 kB)
Using cached pycparser-2.23-py3-none-any.whl (118 kB)
Using cached pyyaml-6.0.3-cp310-cp310-macosx_11_0_arm64.whl (174 kB)
Using cached rich-14.2.0-py3-none-any.whl (243 kB)
Using cached pygments-2.19.2-py3-none-any.whl (1.2 MB)
Using cached markdown_it_py-4.0.0-py3-none-any.whl (87 kB)
Using cached mdurl-0.1.2-py3-none-any.whl (10.0 kB)
Using cached typer-0.21.0-py3-none-any.whl (47 kB)
Using cached click-8.3.1-py3-none-any.whl (108 kB)
Using cached shellingham-1.5.4-py2.py3-none-any.whl (9.8 kB)
Installing collected packages: urllib3, typing_extensions, threadpoolctl, shellingham, pyyaml, pygments, pycparser, platformdirs, packaging, opt_einsum, numpy, msgpack, mdurl, MarkupSafe, llvmlite, joblib, idna, decorator, click, charset_normalizer, certifi, audioread, annotated-types, typing-inspection, soxr, scipy, requests, pydantic-core, numba, ml_dtypes, markdown-it-py, lazy_loader, jinja2, cffi, soundfile, scikit-learn, rich, pydantic, pooch, jaxlib, typer, librosa, jax, tesseract-core
Successfully installed MarkupSafe-3.0.3 annotated-types-0.7.0 audioread-3.1.0 certifi-2026.1.4 cffi-2.0.0 charset_normalizer-3.4.4 click-8.3.1 decorator-5.2.1 idna-3.11 jax-0.6.2 jaxlib-0.6.2 jinja2-3.1.6 joblib-1.5.3 lazy_loader-0.4 librosa-0.11.0 llvmlite-0.46.0 markdown-it-py-4.0.0 mdurl-0.1.2 ml_dtypes-0.5.4 msgpack-1.1.2 numba-0.63.1 numpy-2.2.6 opt_einsum-3.4.0 packaging-25.0 platformdirs-4.5.1 pooch-1.8.2 pycparser-2.23 pydantic-2.12.5 pydantic-core-2.41.5 pygments-2.19.2 pyyaml-6.0.3 requests-2.32.5 rich-14.2.0 scikit-learn-1.7.2 scipy-1.15.3 shellingham-1.5.4 soundfile-0.13.1 soxr-1.0.0 tesseract-core-1.2.0 threadpoolctl-3.6.0 typer-0.21.0 typing-inspection-0.4.2 typing_extensions-4.15.0 urllib3-2.6.2
Building Tesseract components...
Script starting in: /Users/shrinidhirajagopal/sound-hunter
 [i] Building image ...
 [i] Built image sha256:034eb263dbd0, ['audio-filter:1.0.0', 'audio-filter:latest']
["audio-filter:1.0.0", "audio-filter:latest"]
 [i] Building image ...
 [i] Built image sha256:f240b3b39622, ['feature-extractor:1.0.0', 'feature-extractor:latest']
["feature-extractor:1.0.0", "feature-extractor:latest"]
 [i] Building image ...
 [i] Built image sha256:7a2de5c2a17b, ['pattern-detector:1.0.0', 'pattern-detector:latest']
["pattern-detector:1.0.0", "pattern-detector:latest"]
Build complete! Run 'docker images' to see your components.
Testing Tesseract pipeline...
Loading Tesseract components...

Running pipeline on 440 Hz test signal...
  Filter applied
  - Energy: 11036.08
  - Peak frequency: 440.00 Hz
  Features extracted: 10 features
  Pattern detection complete
  - Match: True
  - Confidence: 100.0%
Training the system...
=== Sound Hunter Training System ===

Generating training data...

==================================================
TRAINING FOR BIRD DETECTION
==================================================

Training to detect: 'bird'
Training samples: 20
Positive examples: 5
Epoch 0: Filter: 595-2009 Hz, Energy ratio: 0.22
Epoch 5: Filter: 505-1672 Hz, Energy ratio: 0.15
Epoch 10: Filter: 678-1638 Hz, Energy ratio: 0.10
Epoch 15: Filter: 850-1256 Hz, Energy ratio: 9.45

Training complete!
Optimal filter range: 1082-1132 Hz
Best energy ratio: 39.69

==================================================
TRAINING FOR MOTORCYCLE DETECTION
==================================================

Training to detect: 'motorcycle'
Training samples: 20
Positive examples: 5
Epoch 0: Filter: 578-1899 Hz, Energy ratio: 0.00
Epoch 5: Filter: 945-1320 Hz, Energy ratio: 0.00
Epoch 10: Filter: 1009-1059 Hz, Energy ratio: 0.00
Epoch 15: Filter: 1029-1079 Hz, Energy ratio: 0.00

Training complete!
Optimal filter range: 1029-1079 Hz
Best energy ratio: 0.00

==================================================
TRAINING FOR WHISTLE DETECTION
==================================================

Training to detect: 'whistle'
Training samples: 20
Positive examples: 5
Epoch 0: Filter: 500-2000 Hz, Energy ratio: 30.47
Epoch 5: Filter: 888-2193 Hz, Energy ratio: 42.35
Epoch 10: Filter: 970-2549 Hz, Energy ratio: 40.62
Epoch 15: Filter: 1408-2227 Hz, Energy ratio: 65.77

Training complete!
Optimal filter range: 1344-1917 Hz
Best energy ratio: 118.97

==================================================
SAVING TRAINED MODELS
==================================================

  Models saved to trained_models.json

Summary:
Bird detector:       1082-1132 Hz
Motorcycle detector: 1029-1079 Hz
Whistle detector:    1344-1917 Hz
Retraining for demo purpose...
=== Demonstrating Retraining Capability ===

Testing each detector on different sounds:
------------------------------------------------------------
Detector        Test Sound      Detection    Confidence
------------------------------------------------------------

BIRD DETECTOR (Filter: 1082-1132 Hz)
                bird              DETECTED   90.9%
                motorcycle         Rejected  66.7%
                whistle            Rejected  68.9%
                noise             DETECTED   91.1%

MOTORCYCLE DETECTOR (Filter: 1029-1079 Hz)
                bird              DETECTED   86.6%
                motorcycle        DETECTED   100.0%
                whistle           DETECTED   99.9%
                noise             DETECTED   87.3%

WHISTLE DETECTOR (Filter: 1344-1917 Hz)
                bird              DETECTED   86.0%
                motorcycle         Rejected  19.9%
                whistle           DETECTED   100.0%
                noise             DETECTED   82.3%

============================================================
KEY INSIGHTS:
- Each detector learned different frequency ranges
- Same code, different training data = different behavior
- No hardcoded knowledge about sounds!
- System automatically discovered optimal parameters

Cleaning up Docker containers...
Setup and demo complete!
Shrinidhis-MacBook-Air:sound-hunter shrinidhirajagopal$ ./run.sh 
=== Sound Hunter Project Setup ===
Python 3.10+ not found. Attempting to install...
Installing Python 3.10 via Homebrew...
Error: 
  homebrew-core is a shallow clone.
  homebrew-cask is a shallow clone.
To `brew update`, first run:
  git -C /usr/local/Homebrew/Library/Taps/homebrew/homebrew-core fetch --unshallow
  git -C /usr/local/Homebrew/Library/Taps/homebrew/homebrew-cask fetch --unshallow
These commands may take a few minutes to run due to the large size of the repositories.
This restriction has been made on GitHub's request because updating shallow
clones is an extremely expensive operation due to the tree layout and traffic of
Homebrew/homebrew-core and Homebrew/homebrew-cask. We don't do this for you
automatically to avoid repeatedly performing an expensive unshallow operation in
CI systems (which should instead be fixed to not use shallow clones). Sorry for
the inconvenience!
==> Downloading https://formulae.brew.sh/api/formula.jws.json
#=#=-#                                                                                         
==> Downloading https://formulae.brew.sh/api/cask.jws.json

==> Downloading https://ghcr.io/v2/homebrew/core/python/3.10/manifests/3.10.19_1
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/0e517347476565f8fa7743f84b3c04e6718fa7fcf67af3b44412fb9064a0c8f4--python@3.10-3.10.19_1.bottle_manifest.json
==> Fetching dependencies for python@3.10: gdbm, ca-certificates, openssl@3, readline and sqlite
==> Downloading https://ghcr.io/v2/homebrew/core/gdbm/manifests/1.26
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/35ff1d9b15ba5c57e64b9d7f5e18d12ddda40b5ecdc8ecf2f136c49928265f9d--gdbm-1.26.bottle_manifest.json
==> Fetching gdbm
==> Downloading https://ghcr.io/v2/homebrew/core/gdbm/blobs/sha256:bc3db54835cc359259f83e3d0b30
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/7b2a74b9d7a5de7967de2e69594ce8bccab18c0b1210600622d9aed315e347f4--gdbm--1.26.sonoma.bottle.tar.gz
==> Downloading https://ghcr.io/v2/homebrew/core/ca-certificates/manifests/2025-12-02
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/cbb73f87e0331e0d1422d5d71643918b0833954b03cee5aa178acbee4900f939--ca-certificates-2025-12-02.bottle_manifest.json
==> Fetching ca-certificates
==> Downloading https://ghcr.io/v2/homebrew/core/ca-certificates/blobs/sha256:dd8e78402d2feff01
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/b4902605ac6df93cbe6664aece03fe0c9fc3a1ac79ed37b1cf64227b06c31941--ca-certificates--2025-12-02.all.bottle.tar.gz
==> Downloading https://ghcr.io/v2/homebrew/core/openssl/3/manifests/3.6.0
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/403c903e557d19d801f4c6b4f635c9553af72a487024139a5773e636c884ef9e--openssl@3-3.6.0.bottle_manifest.json
==> Fetching openssl@3
==> Downloading https://ghcr.io/v2/homebrew/core/openssl/3/blobs/sha256:a015d2e06290484b37547a5
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/8dc0f2d4b5d1dc3675652c2239ed47f365d72b5ec28d9c875fddff6150f0b7a0--openssl@3--3.6.0.sequoia.bottle.tar.gz
==> Downloading https://ghcr.io/v2/homebrew/core/readline/manifests/8.3.3
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/0e2d3ef81d48d7d0f5f076c00df9526c2b7ebb2de9bff3972e4d3faabe24d3fb--readline-8.3.3.bottle_manifest.json
==> Fetching readline
==> Downloading https://ghcr.io/v2/homebrew/core/readline/blobs/sha256:fd72a581442e1826e1386b86
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/1dd969814acf96913d41a69b02bdbe92c91714b32b452b36a6f9f2dc890fc7e7--readline--8.3.3.sequoia.bottle.tar.gz
==> Downloading https://ghcr.io/v2/homebrew/core/sqlite/manifests/3.51.1
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/8029a2f3294bb0f1af11d682b254763c6c2c53eaede029ccedc9362bc94aa186--sqlite-3.51.1.bottle_manifest.json
==> Fetching sqlite
==> Downloading https://ghcr.io/v2/homebrew/core/sqlite/blobs/sha256:2422b6f9bab98baab5c64e76d9
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/31e96081f14d54daaf001be48a34efd04f4de49291a3bf48c6ba107a05896ce5--sqlite--3.51.1.sequoia.bottle.tar.gz
==> Fetching python@3.10
==> Downloading https://ghcr.io/v2/homebrew/core/python/3.10/blobs/sha256:41d2532e5b733bfeb604e
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/e89623176ce489e6518a46d7106db2f9903ea8d2faa6e991b47c77e2cfaf3f9f--python@3.10--3.10.19_1.sonoma.bottle.tar.gz
==> Installing dependencies for python@3.10: gdbm, ca-certificates, openssl@3, readline and sqlite
==> Installing python@3.10 dependency: gdbm
==> Downloading https://ghcr.io/v2/homebrew/core/gdbm/manifests/1.26
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/35ff1d9b15ba5c57e64b9d7f5e18d12ddda40b5ecdc8ecf2f136c49928265f9d--gdbm-1.26.bottle_manifest.json
==> Pouring gdbm--1.26.sonoma.bottle.tar.gz
Error: Permission denied @ rb_file_s_rename - (/private/tmp/homebrew-unpack-20260105-81899-6pf63f/gdbm/1.26, /usr/local/Cellar/gdbm/1.26)
Using Python version: 3.10.19

Creating virtual environment...
Virtual environment already exists. Removing old one...
Activating virtual environment...

Upgrading pip...
Requirement already satisfied: pip in ./venv/lib/python3.10/site-packages (25.3)

Installing required packages...
Collecting jax (from -r requirements.txt (line 1))
  Using cached jax-0.6.2-py3-none-any.whl.metadata (13 kB)
Collecting jaxlib (from -r requirements.txt (line 2))
  Using cached jaxlib-0.6.2-cp310-cp310-macosx_11_0_arm64.whl.metadata (1.3 kB)
Collecting tesseract-core>=0.9.0 (from -r requirements.txt (line 5))
  Using cached tesseract_core-1.2.0-py3-none-any.whl.metadata (7.5 kB)
Collecting numpy>=1.26.0 (from -r requirements.txt (line 6))
  Using cached numpy-2.2.6-cp310-cp310-macosx_14_0_arm64.whl.metadata (62 kB)
Collecting scipy>=1.11.0 (from -r requirements.txt (line 7))
  Using cached scipy-1.15.3-cp310-cp310-macosx_14_0_arm64.whl.metadata (61 kB)
Collecting librosa>=0.10.0 (from -r requirements.txt (line 10))
  Using cached librosa-0.11.0-py3-none-any.whl.metadata (8.7 kB)
Collecting soundfile>=0.12.0 (from -r requirements.txt (line 11))
  Using cached soundfile-0.13.1-py2.py3-none-macosx_11_0_arm64.whl.metadata (16 kB)
Collecting scikit-learn>=1.3.0 (from -r requirements.txt (line 14))
  Using cached scikit_learn-1.7.2-cp310-cp310-macosx_12_0_arm64.whl.metadata (11 kB)
Collecting pydantic>=2.0.0 (from -r requirements.txt (line 17))
  Using cached pydantic-2.12.5-py3-none-any.whl.metadata (90 kB)
Collecting ml_dtypes>=0.5.0 (from jax->-r requirements.txt (line 1))
  Using cached ml_dtypes-0.5.4-cp310-cp310-macosx_10_9_universal2.whl.metadata (8.9 kB)
Collecting opt_einsum (from jax->-r requirements.txt (line 1))
  Using cached opt_einsum-3.4.0-py3-none-any.whl.metadata (6.3 kB)
Collecting jinja2 (from tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached jinja2-3.1.6-py3-none-any.whl.metadata (2.9 kB)
Requirement already satisfied: pip in ./venv/lib/python3.10/site-packages (from tesseract-core>=0.9.0->-r requirements.txt (line 5)) (25.3)
Collecting pyyaml (from tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached pyyaml-6.0.3-cp310-cp310-macosx_11_0_arm64.whl.metadata (2.4 kB)
Collecting requests>=2.32.4 (from tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached requests-2.32.5-py3-none-any.whl.metadata (4.9 kB)
Collecting rich (from tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached rich-14.2.0-py3-none-any.whl.metadata (18 kB)
Collecting typer (from tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached typer-0.21.0-py3-none-any.whl.metadata (16 kB)
Collecting audioread>=2.1.9 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached audioread-3.1.0-py3-none-any.whl.metadata (9.0 kB)
Collecting numba>=0.51.0 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached numba-0.63.1-cp310-cp310-macosx_11_0_arm64.whl.metadata (2.9 kB)
Collecting joblib>=1.0 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached joblib-1.5.3-py3-none-any.whl.metadata (5.5 kB)
Collecting decorator>=4.3.0 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached decorator-5.2.1-py3-none-any.whl.metadata (3.9 kB)
Collecting pooch>=1.1 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached pooch-1.8.2-py3-none-any.whl.metadata (10 kB)
Collecting soxr>=0.3.2 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached soxr-1.0.0-cp310-cp310-macosx_11_0_arm64.whl.metadata (5.6 kB)
Collecting typing_extensions>=4.1.1 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
Collecting lazy_loader>=0.1 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached lazy_loader-0.4-py3-none-any.whl.metadata (7.6 kB)
Collecting msgpack>=1.0 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached msgpack-1.1.2-cp310-cp310-macosx_11_0_arm64.whl.metadata (8.1 kB)
Collecting cffi>=1.0 (from soundfile>=0.12.0->-r requirements.txt (line 11))
  Using cached cffi-2.0.0-cp310-cp310-macosx_11_0_arm64.whl.metadata (2.6 kB)
Collecting threadpoolctl>=3.1.0 (from scikit-learn>=1.3.0->-r requirements.txt (line 14))
  Using cached threadpoolctl-3.6.0-py3-none-any.whl.metadata (13 kB)
Collecting annotated-types>=0.6.0 (from pydantic>=2.0.0->-r requirements.txt (line 17))
  Using cached annotated_types-0.7.0-py3-none-any.whl.metadata (15 kB)
Collecting pydantic-core==2.41.5 (from pydantic>=2.0.0->-r requirements.txt (line 17))
  Using cached pydantic_core-2.41.5-cp310-cp310-macosx_11_0_arm64.whl.metadata (7.3 kB)
Collecting typing-inspection>=0.4.2 (from pydantic>=2.0.0->-r requirements.txt (line 17))
  Using cached typing_inspection-0.4.2-py3-none-any.whl.metadata (2.6 kB)
Collecting pycparser (from cffi>=1.0->soundfile>=0.12.0->-r requirements.txt (line 11))
  Using cached pycparser-2.23-py3-none-any.whl.metadata (993 bytes)
Collecting packaging (from lazy_loader>=0.1->librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached packaging-25.0-py3-none-any.whl.metadata (3.3 kB)
Collecting llvmlite<0.47,>=0.46.0dev0 (from numba>=0.51.0->librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached llvmlite-0.46.0-cp310-cp310-macosx_11_0_arm64.whl.metadata (5.0 kB)
Collecting platformdirs>=2.5.0 (from pooch>=1.1->librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached platformdirs-4.5.1-py3-none-any.whl.metadata (12 kB)
Collecting charset_normalizer<4,>=2 (from requests>=2.32.4->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached charset_normalizer-3.4.4-cp310-cp310-macosx_10_9_universal2.whl.metadata (37 kB)
Collecting idna<4,>=2.5 (from requests>=2.32.4->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached idna-3.11-py3-none-any.whl.metadata (8.4 kB)
Collecting urllib3<3,>=1.21.1 (from requests>=2.32.4->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached urllib3-2.6.2-py3-none-any.whl.metadata (6.6 kB)
Collecting certifi>=2017.4.17 (from requests>=2.32.4->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached certifi-2026.1.4-py3-none-any.whl.metadata (2.5 kB)
Collecting MarkupSafe>=2.0 (from jinja2->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached markupsafe-3.0.3-cp310-cp310-macosx_11_0_arm64.whl.metadata (2.7 kB)
Collecting markdown-it-py>=2.2.0 (from rich->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached markdown_it_py-4.0.0-py3-none-any.whl.metadata (7.3 kB)
Collecting pygments<3.0.0,>=2.13.0 (from rich->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached pygments-2.19.2-py3-none-any.whl.metadata (2.5 kB)
Collecting mdurl~=0.1 (from markdown-it-py>=2.2.0->rich->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached mdurl-0.1.2-py3-none-any.whl.metadata (1.6 kB)
Collecting click>=8.0.0 (from typer->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached click-8.3.1-py3-none-any.whl.metadata (2.6 kB)
Collecting shellingham>=1.3.0 (from typer->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached shellingham-1.5.4-py2.py3-none-any.whl.metadata (3.5 kB)
Using cached jax-0.6.2-py3-none-any.whl (2.7 MB)
Using cached jaxlib-0.6.2-cp310-cp310-macosx_11_0_arm64.whl (54.3 MB)
Using cached tesseract_core-1.2.0-py3-none-any.whl (104 kB)
Using cached numpy-2.2.6-cp310-cp310-macosx_14_0_arm64.whl (5.3 MB)
Using cached scipy-1.15.3-cp310-cp310-macosx_14_0_arm64.whl (22.4 MB)
Using cached librosa-0.11.0-py3-none-any.whl (260 kB)
Using cached soundfile-0.13.1-py2.py3-none-macosx_11_0_arm64.whl (1.1 MB)
Using cached scikit_learn-1.7.2-cp310-cp310-macosx_12_0_arm64.whl (8.7 MB)
Using cached pydantic-2.12.5-py3-none-any.whl (463 kB)
Using cached pydantic_core-2.41.5-cp310-cp310-macosx_11_0_arm64.whl (1.9 MB)
Using cached annotated_types-0.7.0-py3-none-any.whl (13 kB)
Using cached audioread-3.1.0-py3-none-any.whl (23 kB)
Using cached cffi-2.0.0-cp310-cp310-macosx_11_0_arm64.whl (180 kB)
Using cached decorator-5.2.1-py3-none-any.whl (9.2 kB)
Using cached joblib-1.5.3-py3-none-any.whl (309 kB)
Using cached lazy_loader-0.4-py3-none-any.whl (12 kB)
Using cached ml_dtypes-0.5.4-cp310-cp310-macosx_10_9_universal2.whl (679 kB)
Using cached msgpack-1.1.2-cp310-cp310-macosx_11_0_arm64.whl (83 kB)
Using cached numba-0.63.1-cp310-cp310-macosx_11_0_arm64.whl (2.7 MB)
Using cached llvmlite-0.46.0-cp310-cp310-macosx_11_0_arm64.whl (37.2 MB)
Using cached pooch-1.8.2-py3-none-any.whl (64 kB)
Using cached packaging-25.0-py3-none-any.whl (66 kB)
Using cached platformdirs-4.5.1-py3-none-any.whl (18 kB)
Using cached requests-2.32.5-py3-none-any.whl (64 kB)
Using cached charset_normalizer-3.4.4-cp310-cp310-macosx_10_9_universal2.whl (209 kB)
Using cached idna-3.11-py3-none-any.whl (71 kB)
Using cached urllib3-2.6.2-py3-none-any.whl (131 kB)
Using cached certifi-2026.1.4-py3-none-any.whl (152 kB)
Using cached soxr-1.0.0-cp310-cp310-macosx_11_0_arm64.whl (164 kB)
Using cached threadpoolctl-3.6.0-py3-none-any.whl (18 kB)
Using cached typing_extensions-4.15.0-py3-none-any.whl (44 kB)
Using cached typing_inspection-0.4.2-py3-none-any.whl (14 kB)
Using cached jinja2-3.1.6-py3-none-any.whl (134 kB)
Using cached markupsafe-3.0.3-cp310-cp310-macosx_11_0_arm64.whl (12 kB)
Using cached opt_einsum-3.4.0-py3-none-any.whl (71 kB)
Using cached pycparser-2.23-py3-none-any.whl (118 kB)
Using cached pyyaml-6.0.3-cp310-cp310-macosx_11_0_arm64.whl (174 kB)
Using cached rich-14.2.0-py3-none-any.whl (243 kB)
Using cached pygments-2.19.2-py3-none-any.whl (1.2 MB)
Using cached markdown_it_py-4.0.0-py3-none-any.whl (87 kB)
Using cached mdurl-0.1.2-py3-none-any.whl (10.0 kB)
Using cached typer-0.21.0-py3-none-any.whl (47 kB)
Using cached click-8.3.1-py3-none-any.whl (108 kB)
Using cached shellingham-1.5.4-py2.py3-none-any.whl (9.8 kB)
Installing collected packages: urllib3, typing_extensions, threadpoolctl, shellingham, pyyaml, pygments, pycparser, platformdirs, packaging, opt_einsum, numpy, msgpack, mdurl, MarkupSafe, llvmlite, joblib, idna, decorator, click, charset_normalizer, certifi, audioread, annotated-types, typing-inspection, soxr, scipy, requests, pydantic-core, numba, ml_dtypes, markdown-it-py, lazy_loader, jinja2, cffi, soundfile, scikit-learn, rich, pydantic, pooch, jaxlib, typer, librosa, jax, tesseract-core
Successfully installed MarkupSafe-3.0.3 annotated-types-0.7.0 audioread-3.1.0 certifi-2026.1.4 cffi-2.0.0 charset_normalizer-3.4.4 click-8.3.1 decorator-5.2.1 idna-3.11 jax-0.6.2 jaxlib-0.6.2 jinja2-3.1.6 joblib-1.5.3 lazy_loader-0.4 librosa-0.11.0 llvmlite-0.46.0 markdown-it-py-4.0.0 mdurl-0.1.2 ml_dtypes-0.5.4 msgpack-1.1.2 numba-0.63.1 numpy-2.2.6 opt_einsum-3.4.0 packaging-25.0 platformdirs-4.5.1 pooch-1.8.2 pycparser-2.23 pydantic-2.12.5 pydantic-core-2.41.5 pygments-2.19.2 pyyaml-6.0.3 requests-2.32.5 rich-14.2.0 scikit-learn-1.7.2 scipy-1.15.3 shellingham-1.5.4 soundfile-0.13.1 soxr-1.0.0 tesseract-core-1.2.0 threadpoolctl-3.6.0 typer-0.21.0 typing-inspection-0.4.2 typing_extensions-4.15.0 urllib3-2.6.2
Building Tesseract components...
Script starting in: /Users/shrinidhirajagopal/sound-hunter
 [i] Building image ...
 [i] Built image sha256:4a076b453324, ['audio-filter:1.0.0', 'audio-filter:latest']
["audio-filter:1.0.0", "audio-filter:latest"]
 [i] Building image ...
 [i] Built image sha256:524f83eb3b35, ['feature-extractor:1.0.0', 'feature-extractor:latest']
["feature-extractor:1.0.0", "feature-extractor:latest"]
 [i] Building image ...
 [i] Built image sha256:3e5adbe6e80e, ['pattern-detector:1.0.0', 'pattern-detector:latest']
["pattern-detector:1.0.0", "pattern-detector:latest"]
Build complete! Run 'docker images' to see your components.
Testing Tesseract pipeline...
Loading Tesseract components...

Running pipeline on 440 Hz test signal...
  Filter applied
  - Energy: 11078.23
  - Peak frequency: 440.00 Hz
  Features extracted: 10 features
  Pattern detection complete
  - Match: True
  - Confidence: 100.0%
Training the system...
=== Sound Hunter Training System ===

Generating training data...

==================================================
TRAINING FOR BIRD DETECTION
==================================================

Training to detect: 'bird'
Training samples: 20
Positive examples: 5
Epoch 0: Filter: 569-1977 Hz, Energy ratio: 0.22
Epoch 5: Filter: 740-1693 Hz, Energy ratio: 0.14
Epoch 10: Filter: 1096-1771 Hz, Energy ratio: 0.09
Epoch 15: Filter: 1518-1763 Hz, Energy ratio: 0.02

Training complete!
Optimal filter range: 1630-1711 Hz
Best energy ratio: 14.04

==================================================
TRAINING FOR MOTORCYCLE DETECTION
==================================================

Training to detect: 'motorcycle'
Training samples: 20
Positive examples: 5
Epoch 0: Filter: 546-1911 Hz, Energy ratio: 0.00
Epoch 5: Filter: 776-1283 Hz, Energy ratio: 0.00
Epoch 10: Filter: 582-1210 Hz, Energy ratio: 0.00
Epoch 15: Filter: 542-911 Hz, Energy ratio: 0.00

Training complete!
Optimal filter range: 430-562 Hz
Best energy ratio: 0.00

==================================================
TRAINING FOR WHISTLE DETECTION
==================================================

Training to detect: 'whistle'
Training samples: 20
Positive examples: 5
Epoch 0: Filter: 718-2081 Hz, Energy ratio: 31.00
Epoch 5: Filter: 1258-2281 Hz, Energy ratio: 50.19
Epoch 10: Filter: 1962-2089 Hz, Energy ratio: 0.00
Epoch 15: Filter: 1906-1956 Hz, Energy ratio: 0.00

Training complete!
Optimal filter range: 1465-2103 Hz
Best energy ratio: 85.99

==================================================
SAVING TRAINED MODELS
==================================================

  Models saved to trained_models.json

Summary:
Bird detector:       1630-1711 Hz
Motorcycle detector: 430-562 Hz
Whistle detector:    1465-2103 Hz
Retraining for demo purpose...
=== Demonstrating Retraining Capability ===

Testing each detector on different sounds:
------------------------------------------------------------
Detector        Test Sound      Detection    Confidence
------------------------------------------------------------

BIRD DETECTOR (Filter: 1630-1711 Hz)
                bird              DETECTED   97.7%
                motorcycle        DETECTED   83.9%
                whistle           DETECTED   98.3%
                noise             DETECTED   96.8%

MOTORCYCLE DETECTOR (Filter: 430-562 Hz)
                bird               Rejected  57.0%
                motorcycle        DETECTED   99.9%
                whistle           DETECTED   98.2%
                noise              Rejected  65.0%

WHISTLE DETECTOR (Filter: 1465-2103 Hz)
                bird               Rejected  65.5%
                motorcycle        DETECTED   99.6%
                whistle            Rejected  19.4%
                noise              Rejected  67.6%

============================================================
KEY INSIGHTS:
- Each detector learned different frequency ranges
- Same code, different training data = different behavior
- No hardcoded knowledge about sounds!
- System automatically discovered optimal parameters

Cleaning up Docker containers...
Setup and demo complete!
Shrinidhis-MacBook-Air:sound-hunter shrinidhirajagopal$ ./run.sh 
=== Sound Hunter Project Setup ===
Python 3.10+ not found. Attempting to install...
Installing Python 3.10 via Homebrew...
Error: 
  homebrew-core is a shallow clone.
  homebrew-cask is a shallow clone.
To `brew update`, first run:
  git -C /usr/local/Homebrew/Library/Taps/homebrew/homebrew-core fetch --unshallow
  git -C /usr/local/Homebrew/Library/Taps/homebrew/homebrew-cask fetch --unshallow
These commands may take a few minutes to run due to the large size of the repositories.
This restriction has been made on GitHub's request because updating shallow
clones is an extremely expensive operation due to the tree layout and traffic of
Homebrew/homebrew-core and Homebrew/homebrew-cask. We don't do this for you
automatically to avoid repeatedly performing an expensive unshallow operation in
CI systems (which should instead be fixed to not use shallow clones). Sorry for
the inconvenience!
==> Downloading https://ghcr.io/v2/homebrew/core/python/3.10/manifests/3.10.19_1
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/0e517347476565f8fa7743f84b3c04e6718fa7fcf67af3b44412fb9064a0c8f4--python@3.10-3.10.19_1.bottle_manifest.json
==> Fetching dependencies for python@3.10: gdbm, ca-certificates, openssl@3, readline and sqlite
==> Downloading https://ghcr.io/v2/homebrew/core/gdbm/manifests/1.26
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/35ff1d9b15ba5c57e64b9d7f5e18d12ddda40b5ecdc8ecf2f136c49928265f9d--gdbm-1.26.bottle_manifest.json
==> Fetching gdbm
==> Downloading https://ghcr.io/v2/homebrew/core/gdbm/blobs/sha256:bc3db54835cc359259f83e3d0b30
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/7b2a74b9d7a5de7967de2e69594ce8bccab18c0b1210600622d9aed315e347f4--gdbm--1.26.sonoma.bottle.tar.gz
==> Downloading https://ghcr.io/v2/homebrew/core/ca-certificates/manifests/2025-12-02
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/cbb73f87e0331e0d1422d5d71643918b0833954b03cee5aa178acbee4900f939--ca-certificates-2025-12-02.bottle_manifest.json
==> Fetching ca-certificates
==> Downloading https://ghcr.io/v2/homebrew/core/ca-certificates/blobs/sha256:dd8e78402d2feff01
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/b4902605ac6df93cbe6664aece03fe0c9fc3a1ac79ed37b1cf64227b06c31941--ca-certificates--2025-12-02.all.bottle.tar.gz
==> Downloading https://ghcr.io/v2/homebrew/core/openssl/3/manifests/3.6.0
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/403c903e557d19d801f4c6b4f635c9553af72a487024139a5773e636c884ef9e--openssl@3-3.6.0.bottle_manifest.json
==> Fetching openssl@3
==> Downloading https://ghcr.io/v2/homebrew/core/openssl/3/blobs/sha256:a015d2e06290484b37547a5
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/8dc0f2d4b5d1dc3675652c2239ed47f365d72b5ec28d9c875fddff6150f0b7a0--openssl@3--3.6.0.sequoia.bottle.tar.gz
==> Downloading https://ghcr.io/v2/homebrew/core/readline/manifests/8.3.3
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/0e2d3ef81d48d7d0f5f076c00df9526c2b7ebb2de9bff3972e4d3faabe24d3fb--readline-8.3.3.bottle_manifest.json
==> Fetching readline
==> Downloading https://ghcr.io/v2/homebrew/core/readline/blobs/sha256:fd72a581442e1826e1386b86
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/1dd969814acf96913d41a69b02bdbe92c91714b32b452b36a6f9f2dc890fc7e7--readline--8.3.3.sequoia.bottle.tar.gz
==> Downloading https://ghcr.io/v2/homebrew/core/sqlite/manifests/3.51.1
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/8029a2f3294bb0f1af11d682b254763c6c2c53eaede029ccedc9362bc94aa186--sqlite-3.51.1.bottle_manifest.json
==> Fetching sqlite
==> Downloading https://ghcr.io/v2/homebrew/core/sqlite/blobs/sha256:2422b6f9bab98baab5c64e76d9
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/31e96081f14d54daaf001be48a34efd04f4de49291a3bf48c6ba107a05896ce5--sqlite--3.51.1.sequoia.bottle.tar.gz
==> Fetching python@3.10
==> Downloading https://ghcr.io/v2/homebrew/core/python/3.10/blobs/sha256:41d2532e5b733bfeb604e
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/e89623176ce489e6518a46d7106db2f9903ea8d2faa6e991b47c77e2cfaf3f9f--python@3.10--3.10.19_1.sonoma.bottle.tar.gz
==> Installing dependencies for python@3.10: gdbm, ca-certificates, openssl@3, readline and sqlite
==> Installing python@3.10 dependency: gdbm
==> Downloading https://ghcr.io/v2/homebrew/core/gdbm/manifests/1.26
Already downloaded: /Users/shrinidhirajagopal/Library/Caches/Homebrew/downloads/35ff1d9b15ba5c57e64b9d7f5e18d12ddda40b5ecdc8ecf2f136c49928265f9d--gdbm-1.26.bottle_manifest.json
==> Pouring gdbm--1.26.sonoma.bottle.tar.gz
Error: Permission denied @ rb_file_s_rename - (/private/tmp/homebrew-unpack-20260105-83944-6ci219/gdbm/1.26, /usr/local/Cellar/gdbm/1.26)
Using Python version: 3.10.19

Creating virtual environment...
Virtual environment already exists. Removing old one...
Activating virtual environment...

Upgrading pip...
Requirement already satisfied: pip in ./venv/lib/python3.10/site-packages (25.3)

Installing required packages...
Collecting jax (from -r requirements.txt (line 1))
  Using cached jax-0.6.2-py3-none-any.whl.metadata (13 kB)
Collecting jaxlib (from -r requirements.txt (line 2))
  Using cached jaxlib-0.6.2-cp310-cp310-macosx_11_0_arm64.whl.metadata (1.3 kB)
Collecting tesseract-core>=0.9.0 (from -r requirements.txt (line 5))
  Using cached tesseract_core-1.2.0-py3-none-any.whl.metadata (7.5 kB)
Collecting numpy>=1.26.0 (from -r requirements.txt (line 6))
  Using cached numpy-2.2.6-cp310-cp310-macosx_14_0_arm64.whl.metadata (62 kB)
Collecting scipy>=1.11.0 (from -r requirements.txt (line 7))
  Using cached scipy-1.15.3-cp310-cp310-macosx_14_0_arm64.whl.metadata (61 kB)
Collecting librosa>=0.10.0 (from -r requirements.txt (line 10))
  Using cached librosa-0.11.0-py3-none-any.whl.metadata (8.7 kB)
Collecting soundfile>=0.12.0 (from -r requirements.txt (line 11))
  Using cached soundfile-0.13.1-py2.py3-none-macosx_11_0_arm64.whl.metadata (16 kB)
Collecting scikit-learn>=1.3.0 (from -r requirements.txt (line 14))
  Using cached scikit_learn-1.7.2-cp310-cp310-macosx_12_0_arm64.whl.metadata (11 kB)
Collecting pydantic>=2.0.0 (from -r requirements.txt (line 17))
  Using cached pydantic-2.12.5-py3-none-any.whl.metadata (90 kB)
Collecting ml_dtypes>=0.5.0 (from jax->-r requirements.txt (line 1))
  Using cached ml_dtypes-0.5.4-cp310-cp310-macosx_10_9_universal2.whl.metadata (8.9 kB)
Collecting opt_einsum (from jax->-r requirements.txt (line 1))
  Using cached opt_einsum-3.4.0-py3-none-any.whl.metadata (6.3 kB)
Collecting jinja2 (from tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached jinja2-3.1.6-py3-none-any.whl.metadata (2.9 kB)
Requirement already satisfied: pip in ./venv/lib/python3.10/site-packages (from tesseract-core>=0.9.0->-r requirements.txt (line 5)) (25.3)
Collecting pyyaml (from tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached pyyaml-6.0.3-cp310-cp310-macosx_11_0_arm64.whl.metadata (2.4 kB)
Collecting requests>=2.32.4 (from tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached requests-2.32.5-py3-none-any.whl.metadata (4.9 kB)
Collecting rich (from tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached rich-14.2.0-py3-none-any.whl.metadata (18 kB)
Collecting typer (from tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached typer-0.21.0-py3-none-any.whl.metadata (16 kB)
Collecting audioread>=2.1.9 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached audioread-3.1.0-py3-none-any.whl.metadata (9.0 kB)
Collecting numba>=0.51.0 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached numba-0.63.1-cp310-cp310-macosx_11_0_arm64.whl.metadata (2.9 kB)
Collecting joblib>=1.0 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached joblib-1.5.3-py3-none-any.whl.metadata (5.5 kB)
Collecting decorator>=4.3.0 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached decorator-5.2.1-py3-none-any.whl.metadata (3.9 kB)
Collecting pooch>=1.1 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached pooch-1.8.2-py3-none-any.whl.metadata (10 kB)
Collecting soxr>=0.3.2 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached soxr-1.0.0-cp310-cp310-macosx_11_0_arm64.whl.metadata (5.6 kB)
Collecting typing_extensions>=4.1.1 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
Collecting lazy_loader>=0.1 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached lazy_loader-0.4-py3-none-any.whl.metadata (7.6 kB)
Collecting msgpack>=1.0 (from librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached msgpack-1.1.2-cp310-cp310-macosx_11_0_arm64.whl.metadata (8.1 kB)
Collecting cffi>=1.0 (from soundfile>=0.12.0->-r requirements.txt (line 11))
  Using cached cffi-2.0.0-cp310-cp310-macosx_11_0_arm64.whl.metadata (2.6 kB)
Collecting threadpoolctl>=3.1.0 (from scikit-learn>=1.3.0->-r requirements.txt (line 14))
  Using cached threadpoolctl-3.6.0-py3-none-any.whl.metadata (13 kB)
Collecting annotated-types>=0.6.0 (from pydantic>=2.0.0->-r requirements.txt (line 17))
  Using cached annotated_types-0.7.0-py3-none-any.whl.metadata (15 kB)
Collecting pydantic-core==2.41.5 (from pydantic>=2.0.0->-r requirements.txt (line 17))
  Using cached pydantic_core-2.41.5-cp310-cp310-macosx_11_0_arm64.whl.metadata (7.3 kB)
Collecting typing-inspection>=0.4.2 (from pydantic>=2.0.0->-r requirements.txt (line 17))
  Using cached typing_inspection-0.4.2-py3-none-any.whl.metadata (2.6 kB)
Collecting pycparser (from cffi>=1.0->soundfile>=0.12.0->-r requirements.txt (line 11))
  Using cached pycparser-2.23-py3-none-any.whl.metadata (993 bytes)
Collecting packaging (from lazy_loader>=0.1->librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached packaging-25.0-py3-none-any.whl.metadata (3.3 kB)
Collecting llvmlite<0.47,>=0.46.0dev0 (from numba>=0.51.0->librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached llvmlite-0.46.0-cp310-cp310-macosx_11_0_arm64.whl.metadata (5.0 kB)
Collecting platformdirs>=2.5.0 (from pooch>=1.1->librosa>=0.10.0->-r requirements.txt (line 10))
  Using cached platformdirs-4.5.1-py3-none-any.whl.metadata (12 kB)
Collecting charset_normalizer<4,>=2 (from requests>=2.32.4->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached charset_normalizer-3.4.4-cp310-cp310-macosx_10_9_universal2.whl.metadata (37 kB)
Collecting idna<4,>=2.5 (from requests>=2.32.4->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached idna-3.11-py3-none-any.whl.metadata (8.4 kB)
Collecting urllib3<3,>=1.21.1 (from requests>=2.32.4->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached urllib3-2.6.2-py3-none-any.whl.metadata (6.6 kB)
Collecting certifi>=2017.4.17 (from requests>=2.32.4->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached certifi-2026.1.4-py3-none-any.whl.metadata (2.5 kB)
Collecting MarkupSafe>=2.0 (from jinja2->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached markupsafe-3.0.3-cp310-cp310-macosx_11_0_arm64.whl.metadata (2.7 kB)
Collecting markdown-it-py>=2.2.0 (from rich->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached markdown_it_py-4.0.0-py3-none-any.whl.metadata (7.3 kB)
Collecting pygments<3.0.0,>=2.13.0 (from rich->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached pygments-2.19.2-py3-none-any.whl.metadata (2.5 kB)
Collecting mdurl~=0.1 (from markdown-it-py>=2.2.0->rich->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached mdurl-0.1.2-py3-none-any.whl.metadata (1.6 kB)
Collecting click>=8.0.0 (from typer->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached click-8.3.1-py3-none-any.whl.metadata (2.6 kB)
Collecting shellingham>=1.3.0 (from typer->tesseract-core>=0.9.0->-r requirements.txt (line 5))
  Using cached shellingham-1.5.4-py2.py3-none-any.whl.metadata (3.5 kB)
Using cached jax-0.6.2-py3-none-any.whl (2.7 MB)
Using cached jaxlib-0.6.2-cp310-cp310-macosx_11_0_arm64.whl (54.3 MB)
Using cached tesseract_core-1.2.0-py3-none-any.whl (104 kB)
Using cached numpy-2.2.6-cp310-cp310-macosx_14_0_arm64.whl (5.3 MB)
Using cached scipy-1.15.3-cp310-cp310-macosx_14_0_arm64.whl (22.4 MB)
Using cached librosa-0.11.0-py3-none-any.whl (260 kB)
Using cached soundfile-0.13.1-py2.py3-none-macosx_11_0_arm64.whl (1.1 MB)
Using cached scikit_learn-1.7.2-cp310-cp310-macosx_12_0_arm64.whl (8.7 MB)
Using cached pydantic-2.12.5-py3-none-any.whl (463 kB)
Using cached pydantic_core-2.41.5-cp310-cp310-macosx_11_0_arm64.whl (1.9 MB)
Using cached annotated_types-0.7.0-py3-none-any.whl (13 kB)
Using cached audioread-3.1.0-py3-none-any.whl (23 kB)
Using cached cffi-2.0.0-cp310-cp310-macosx_11_0_arm64.whl (180 kB)
Using cached decorator-5.2.1-py3-none-any.whl (9.2 kB)
Using cached joblib-1.5.3-py3-none-any.whl (309 kB)
Using cached lazy_loader-0.4-py3-none-any.whl (12 kB)
Using cached ml_dtypes-0.5.4-cp310-cp310-macosx_10_9_universal2.whl (679 kB)
Using cached msgpack-1.1.2-cp310-cp310-macosx_11_0_arm64.whl (83 kB)
Using cached numba-0.63.1-cp310-cp310-macosx_11_0_arm64.whl (2.7 MB)
Using cached llvmlite-0.46.0-cp310-cp310-macosx_11_0_arm64.whl (37.2 MB)
Using cached pooch-1.8.2-py3-none-any.whl (64 kB)
Using cached packaging-25.0-py3-none-any.whl (66 kB)
Using cached platformdirs-4.5.1-py3-none-any.whl (18 kB)
Using cached requests-2.32.5-py3-none-any.whl (64 kB)
Using cached charset_normalizer-3.4.4-cp310-cp310-macosx_10_9_universal2.whl (209 kB)
Using cached idna-3.11-py3-none-any.whl (71 kB)
Using cached urllib3-2.6.2-py3-none-any.whl (131 kB)
Using cached certifi-2026.1.4-py3-none-any.whl (152 kB)
Using cached soxr-1.0.0-cp310-cp310-macosx_11_0_arm64.whl (164 kB)
Using cached threadpoolctl-3.6.0-py3-none-any.whl (18 kB)
Using cached typing_extensions-4.15.0-py3-none-any.whl (44 kB)
Using cached typing_inspection-0.4.2-py3-none-any.whl (14 kB)
Using cached jinja2-3.1.6-py3-none-any.whl (134 kB)
Using cached markupsafe-3.0.3-cp310-cp310-macosx_11_0_arm64.whl (12 kB)
Using cached opt_einsum-3.4.0-py3-none-any.whl (71 kB)
Using cached pycparser-2.23-py3-none-any.whl (118 kB)
Using cached pyyaml-6.0.3-cp310-cp310-macosx_11_0_arm64.whl (174 kB)
Using cached rich-14.2.0-py3-none-any.whl (243 kB)
Using cached pygments-2.19.2-py3-none-any.whl (1.2 MB)
Using cached markdown_it_py-4.0.0-py3-none-any.whl (87 kB)
Using cached mdurl-0.1.2-py3-none-any.whl (10.0 kB)
Using cached typer-0.21.0-py3-none-any.whl (47 kB)
Using cached click-8.3.1-py3-none-any.whl (108 kB)
Using cached shellingham-1.5.4-py2.py3-none-any.whl (9.8 kB)
Installing collected packages: urllib3, typing_extensions, threadpoolctl, shellingham, pyyaml, pygments, pycparser, platformdirs, packaging, opt_einsum, numpy, msgpack, mdurl, MarkupSafe, llvmlite, joblib, idna, decorator, click, charset_normalizer, certifi, audioread, annotated-types, typing-inspection, soxr, scipy, requests, pydantic-core, numba, ml_dtypes, markdown-it-py, lazy_loader, jinja2, cffi, soundfile, scikit-learn, rich, pydantic, pooch, jaxlib, typer, librosa, jax, tesseract-core
Successfully installed MarkupSafe-3.0.3 annotated-types-0.7.0 audioread-3.1.0 certifi-2026.1.4 cffi-2.0.0 charset_normalizer-3.4.4 click-8.3.1 decorator-5.2.1 idna-3.11 jax-0.6.2 jaxlib-0.6.2 jinja2-3.1.6 joblib-1.5.3 lazy_loader-0.4 librosa-0.11.0 llvmlite-0.46.0 markdown-it-py-4.0.0 mdurl-0.1.2 ml_dtypes-0.5.4 msgpack-1.1.2 numba-0.63.1 numpy-2.2.6 opt_einsum-3.4.0 packaging-25.0 platformdirs-4.5.1 pooch-1.8.2 pycparser-2.23 pydantic-2.12.5 pydantic-core-2.41.5 pygments-2.19.2 pyyaml-6.0.3 requests-2.32.5 rich-14.2.0 scikit-learn-1.7.2 scipy-1.15.3 shellingham-1.5.4 soundfile-0.13.1 soxr-1.0.0 tesseract-core-1.2.0 threadpoolctl-3.6.0 typer-0.21.0 typing-inspection-0.4.2 typing_extensions-4.15.0 urllib3-2.6.2
Building Tesseract components...
Script starting in: /Users/shrinidhirajagopal/sound-hunter
 [i] Building image ...
 [i] Built image sha256:7ab4d63efb5f, ['audio-filter:1.0.0', 'audio-filter:latest']
["audio-filter:1.0.0", "audio-filter:latest"]
 [i] Building image ...
 [i] Built image sha256:1d5ef8401f76, ['feature-extractor:1.0.0', 'feature-extractor:latest']
["feature-extractor:1.0.0", "feature-extractor:latest"]
 [i] Building image ...
 [i] Built image sha256:c68204fb937d, ['pattern-detector:1.0.0', 'pattern-detector:latest']
["pattern-detector:1.0.0", "pattern-detector:latest"]
Build complete! Run 'docker images' to see your components.
Testing Tesseract pipeline...
Loading Tesseract components...

Running pipeline on 440 Hz test signal...
  Filter applied
  - Energy: 11035.46
  - Peak frequency: 440.00 Hz
  Features extracted: 10 features
  Pattern detection complete
  - Match: True
  - Confidence: 100.0%
Training the system...
=== Sound Hunter Training System ===

Generating training data...

==================================================
TRAINING FOR BIRD DETECTION
==================================================

Training to detect: 'bird'
Training samples: 20
Positive examples: 5
Epoch 0: Filter: 874-2040 Hz, Energy ratio: 0.13
Epoch 5: Filter: 1317-1958 Hz, Energy ratio: 0.07
Epoch 10: Filter: 1673-1886 Hz, Energy ratio: 10.67
Epoch 15: Filter: 1979-2029 Hz, Energy ratio: 5.34

Training complete!
Optimal filter range: 1792-1842 Hz
Best energy ratio: 25.43

==================================================
TRAINING FOR MOTORCYCLE DETECTION
==================================================

Training to detect: 'motorcycle'
Training samples: 20
Positive examples: 5
Epoch 0: Filter: 20-457 Hz, Energy ratio: 13.19
Epoch 5: Filter: 96-366 Hz, Energy ratio: 125.07
Epoch 10: Filter: 281-427 Hz, Energy ratio: 38.62
Epoch 15: Filter: 481-531 Hz, Energy ratio: 0.00

Training complete!
Optimal filter range: 188-238 Hz
Best energy ratio: 143.34

==================================================
TRAINING FOR WHISTLE DETECTION
==================================================

Training to detect: 'whistle'
Training samples: 20
Positive examples: 5
Epoch 0: Filter: 967-2053 Hz, Energy ratio: 55.11
Epoch 5: Filter: 1529-1579 Hz, Energy ratio: 247.04
Epoch 10: Filter: 1670-1720 Hz, Energy ratio: 0.01
Epoch 15: Filter: 1678-1839 Hz, Energy ratio: 0.00

Training complete!
Optimal filter range: 1541-1591 Hz
Best energy ratio: 397.30

==================================================
SAVING TRAINED MODELS
==================================================

  Models saved to trained_models.json

Summary:
Bird detector:       1792-1842 Hz
Motorcycle detector: 188-238 Hz
Whistle detector:    1541-1591 Hz
Retraining for demo purpose...
=== Demonstrating Retraining Capability ===

Testing each detector on different sounds:
------------------------------------------------------------
Detector        Test Sound      Detection    Confidence
------------------------------------------------------------

BIRD DETECTOR (Filter: 1792-1842 Hz)
                bird              DETECTED   99.3%
                motorcycle        DETECTED   89.8%
                whistle           DETECTED   92.6%
                noise             DETECTED   97.7%

MOTORCYCLE DETECTOR (Filter: 188-238 Hz)
                bird              DETECTED   93.0%
                motorcycle         Rejected  23.8%
                whistle            Rejected  14.5%
                noise             DETECTED   92.8%

WHISTLE DETECTOR (Filter: 1541-1591 Hz)
                bird              DETECTED   96.8%
                motorcycle        DETECTED   99.8%
                whistle           DETECTED   87.2%
                noise             DETECTED   81.0%

============================================================
KEY INSIGHTS:
- Each detector learned different frequency ranges
- Same code, different training data = different behavior
- No hardcoded knowledge about sounds!
- System automatically discovered optimal parameters

Cleaning up Docker containers...
Setup and demo complete!
Shrinidhis-MacBook-Air:sound-hunter shrinidhirajagopal$ 